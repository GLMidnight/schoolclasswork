"use strict";PULSE.app.templates.adandccdescriptions='<span class="label label--cc" alt="">{{ closedCap-label }}</span> <span class="label label--ad" alt="">{{ audioDesc-label }}</span><div class="desc-container"><span class="desc-text">{{ audioDesc-text }}</span> <span class="icon" alt=""></span></div>',PULSE.app.templates.audiodescriptioncta='<span class="label label--ad" alt="">{{ audioDesc-label }}</span><div class="desc-container"><span class="desc-text">{{ audioDesc-text }}</span> <span class="icon" alt=""></span></div>',PULSE.app.templates.closedcaption='<span class="label label--cc" alt="">{{ closedCap-label }}</span>',PULSE.app.templates.disableaudiodescriptioncta='<span class="label label--cc" alt="">{{ closedCap-label }}</span> <span class="label label--ad" alt="">{{ audioDesc-label }}</span><div class="desc-container"><span class="desc-text">{{ disAudioDesc-text }}</span> <span class="icon" alt=""></span></div>',function(i,s){function e(){n=[],this.scriptSource="//players.brightcove.net/{{account}}/{{playerId}}_default/index.min.js?{{elementId}}",this.createScripts()}var o={},n=[];e.prototype.getPlayer=function(){if(n[0])return this.players[n[0]]},e.prototype.getPlayersMap=function(){return o},e.prototype.getPlayerNameArray=function(){return n},e.prototype.getPlayerWithName=function(t,e){var a=n.filter(function(e){return e===t});return 0<a.length?o[a[0]]:!(!e||!o[0])&&o[0]},e.prototype.createPlayers=function(e){videojs(this.getAttribute("data-player")).ready(function(){var e=new Event("videoReady"+this.id_);o[this.id_]=new i.brightCoveVideo(this.el_.parentElement,this),n.push(this.id_),window.dispatchEvent(e),o[this.id_]=new i.brightCoveVideo(this.el_.parentElement,this),n.push(this.id_),videojs(this.id_).on("play",function(){i.common.event.dispatch(i.common.event.VIDEO.PLAY,{playerId:this.id_,mediaId:this.mediainfo.id},this.el_)}),videojs(this.id_).on("pause",function(){i.common.event.dispatch(i.common.event.VIDEO.PAUSE,{playerId:this.id_,mediaId:this.mediainfo.id},this.el_)}),videojs(this.id_).on("ended",function(){i.common.event.dispatch(i.common.event.VIDEO.END,{playerId:this.id_,mediaId:this.mediainfo.id},this.el_)})})},e.prototype.createScripts=function(){var d=this,l=[],e=document.querySelectorAll("video");Array.prototype.map.call(e,function(e,t,a){var i={account:e.getAttribute("data-account"),playerId:e.getAttribute("data-player"),vttId:e.getAttribute("data-webVTT-id"),elementId:e.getAttribute("id")},o=s.common.formatString(d.scriptSource,i);if(-1===l.indexOf(o)){var n=document.createElement("script");n.setAttribute("data-player",i.elementId),document.getElementsByTagName("body")[0].appendChild(n),n.onload=d.createPlayers,n.src=o,l.push(o)}})},i.videoPlayerManager=new e,i.videoPlayerManager.onTemplateLoaded=function(e){var t=brightcove.api.getExperience(e),a=t.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER);i.videoPlayerManager.registerPlayerApi(e,t,a)}}(PULSE.app,PULSE.core),function(l,s,i){l.brightCoveVideo=function(e,t){var a=this;a.name=t.id_||"default_player",a.api=t,a.catalog=a.api.catalog,a.players=document.querySelectorAll('[data-widget="video-player"]'),a.modalPlayer=document.querySelector("#plVideoModal video"),a.model={"audioDesc-label":i.lookup("label.audiodescription"),"audioDesc-text":i.lookup("label.audiodescriptionavailable"),"disAudioDesc-text":i.lookup("label.disableaudiodescription"),"closedCap-label":i.lookup("label.closedcaption")},a.idToPlayOnLoad=!1,a.ready=!1,a.element=e,a.metaElements=!1,a.attemptToFindMetaDivs(),a.hasWebVTT()},l.brightCoveVideo.prototype.setupTracking=function(){document.querySelectorAll(".video-js video").forEach(function(i){var e=i.id,o=videojs(e);o.off("play"),o.on("play",function(){var e=Math.floor(o.cache_.currentTime),t=Math.floor(o.cache_.duration);if(0===e||e===t){var a={contentType:"VIDEO",contentId:parseInt(i.dataset.trackerId),action:"VIEW"};l.ContentTracker(a)}})})},l.brightCoveVideo.prototype.attemptToFindMetaDivs=function(){var e=this;e.auidoElement=e.element.querySelector(".audioDesc")||!1,e.captionElement=e.element.querySelector(".closedCaption")||!1,e.metaElements={title:e.element.querySelector(".videoTitle")||!1,description:e.element.querySelector(".videoDescription")||!1,date:e.element.querySelector(".videoDate")||!1}},l.brightCoveVideo.prototype.hasWebVTT=function(){var e=this;e.embeddedVTT=e.element.firstElementChild.getAttribute("data-webVTT-id"),e.embeddedId=e.element.firstElementChild.getAttribute("data-video-id"),e.embeddedVTT&&e.embeddedId&&(e.articleEmbed=!0,e.addCaptions()),e.setupTracking()},l.brightCoveVideo.prototype.setMeta=function(a){var i=this;if(Object.keys(i.metaElements).map(function(e){var t=i.metaElements[e];t&&a[e]?t.innerHTML=a[e]:t&&"audioDesc"!==t.className&&(t.innerHTML="")}),a.hotlinkText&&a.hotlinkUrl&&-1!==a.description.indexOf(a.hotlinkText)){var e=-1===a.hotlinkUrl.indexOf(l.environment.domain)?'target="_blank"':"",t='<a href="'+a.hotlinkUrl+'"'+e+">"+a.hotlinkText+"</a>",o=a.description.replace(a.hotlinkText,t);i.metaElements.description.innerHTML=o}if(a.contentId){var n=i.element.parentNode.getElementsByClassName("videoSocialShare")[0],d=window.location.hostname+"/video/single/"+a.contentId;i.modalPlayer.setAttribute("data-tracking-id",a.contentId),i.pageShare?i.pageShare.setUrl(d):i.pageShare=new s.pageShare(n,d)}},l.brightCoveVideo.prototype.setApiControllers=function(e,t){var a=this;a.player=e,a.api=t,a.ready=!0,a.idToPlayOnLoad&&(a.playVideoWithID(a.idToPlayOnLoad),a.api.pause(!1))},l.brightCoveVideo.prototype.playVideoWithID=function(e,a){var i=this;if(i.videoID&&a||(i.videoID=e),!i.embeddedVTT)for(var t=0;t<i.players.length;t++)i.players[t].style.display="";i.catalog.getVideo(e,function(e,t){i.catalog.load(t),i.api.play(),i.resetCaptions(a),i.addCaptions(a)}),i.playVideo(e)},l.brightCoveVideo.prototype.resetCaptions=function(e){e||(this.auidoElement&&(this.auidoElement.innerHTML=""),this.captionElement&&(this.captionElement.innerHTML=""))},l.brightCoveVideo.prototype.addCaptions=function(e){var t=this;if(t.api.mediainfo&&t.api.mediainfo.custom_fields&&t.api.mediainfo.custom_fields.web_vtt){var a=!(!t.api.mediainfo.custom_fields||!t.api.mediainfo.custom_fields.web_vtt),i=0<t.api.mediainfo.textTracks.length||0<t.api.mediainfo.text_tracks.length;i&&a?(t.metaElements.audioDesc=t.auidoElement,t.renderCaption(l.templates.adandccdescriptions,t.metaElements.audioDesc)):a&&!i?(t.metaElements.audioDesc=t.auidoElement,t.renderCaption(l.templates.audiodescriptioncta,t.metaElements.audioDesc)):i&&!a&&(t.metaElements.closedCaption=t.captionElement,t.renderCaption(l.templates.closedcaption,t.metaElements.closedCaption))}else t.articleEmbed&&!e&&(t.metaElements.audioDesc=t.auidoElement,t.renderCaption(l.templates.audiodescriptioncta,t.metaElements.audioDesc))},l.brightCoveVideo.prototype.renderCaption=function(e,t){t&&(t.innerHTML=Mustache.render(e,this.model),this.setListeners(t))},l.brightCoveVideo.prototype.setListeners=function(i,e){var o=this;["keypress","click"].forEach(function(e){i.addEventListener(e,function(e){if(13===e.which||"click"===e.type){var t=o.api.mediainfo.custom_fields.web_vtt;if(t)i.innerHTML=Mustache.render(l.templates.disableaudiodescriptioncta,o.model),o.playVideoWithID(t,!0);else{i.innerHTML=Mustache.render(l.templates.audiodescriptioncta,o.model);var a="";a=o.embeddedId?o.embeddedId:o.videoID,o.playVideoWithID(a)}}})})},l.brightCoveVideo.prototype.stopVideo=function(){this.api.pause()},l.brightCoveVideo.prototype.playVideo=function(e){},l.brightCoveVideo.prototype.resetPlayer=function(){this.api.reset()};document.querySelectorAll('[data-widget="video-player"]')}(PULSE.app,PULSE.app.common,PULSE.I18N);